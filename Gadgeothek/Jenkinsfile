pipeline {
	agent {
		node {
      		label 'jenkins-slave1.yvu.ch'
    	}
	}
	stages {
		stage('Build') {
			steps {
				sh 'echo Build'
				sh 'cd Gadgeothek; ./gradlew build'
			}
	    	post {
           	    success {
               	    archiveArtifacts '**/outputs/apk/*.apk'
                 }
                 always {
                    junit allowEmptyResults: true, testResults: '**/build/test-results/testDemoDebugUnitTest/*.xml'
                    publishHTML([allowMissing: true, alwaysLinkToLastBuild: false, keepAll: false, reportDir: 'Gadgeothek/app/build/reports', reportFiles: 'lint-results.html', reportName: 'Lint Results', reportTitles: ''])
                    sh 'cd Gadgeothek; export revision="$(git rev-parse HEAD)"; ./gradlew storeResults'
                 }
             }
		}

		stage('End2End Tests') {
		    steps {
		        sh 'echo End2End Tests'
		    }
		}

		stage('Package') {
		    steps {
		        sh 'echo Package'
		    }
		}
	}
	post {
	    always {
    	    cleanWs()
	    }
	}
}
